
# Foodgram - –í–¥–æ—Ö–Ω–æ–≤–ª—è–π—Ç–µ—Å—å –∏ –¥–µ–ª–∏—Ç–µ—Å—å –≤–∫—É—Å–Ω—ã–º–∏ –±–ª—é–¥–∞–º–∏ —Å–æ –≤—Å–µ–º –º–∏—Ä–æ–º!

***

#### –°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç: primestr.sytes.net

***

# –†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è

Looking for English version? Check here --> [click](#english-version) or scroll down.

***
***

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:

[![Python](https://img.shields.io/badge/Python-%203.10-blue?style=flat-square&logo=Python)](https://www.python.org/)
[![Django](https://img.shields.io/badge/Django-%203.2.3-blue?style=flat-square&logo=django)](https://www.djangoproject.com/)
[![DRF](https://img.shields.io/badge/DjangoRESTFramework-%20-blue?style=flat-square&logo=django)](https://www.django-rest-framework.org/)
[![Docker](https://img.shields.io/badge/Docker-%2024.0.5-blue?style=flat-square&logo=docker)](https://www.docker.com/)
[![DockerCompose](https://img.shields.io/badge/Docker_Compose-%202.21.0-blue?style=flat-square&logo=docsdotrs)](https://docs.docker.com/compose/)
[![GitHub Actions](https://img.shields.io/badge/GitHub_Actions-%20-blue?style=flat-square&logo=githubactions)](https://github.com/features/actions)
[![Gunicorn](https://img.shields.io/badge/Gunicorn-%2020.1.0-blue?style=flat-square&logo=gunicorn)](https://gunicorn.org/)
[![Nginx](https://img.shields.io/badge/Nginx-%20-blue?style=flat-square&logo=nginx)](https://www.nginx.com/)
[![React](https://img.shields.io/badge/React-%20-blue?style=flat-square&logo=react)](https://react.dev/)
[![React](https://img.shields.io/badge/certbot-%20-blue?style=flat-square&logo=letsencrypt)](https://certbot.eff.org/)

***

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:

Foodgram –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–æ–≤: –°–æ–∑–¥–∞–π—Ç–µ –∫—Ä–∞—Å–∏–≤–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã, –¥–æ–±–∞–≤–ª—è–π—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤–∞—à–∏—Ö –±–ª—é–¥ –∏ —Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ –¥—Ä—É–≥–∏–º, –∫–∞–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –∏—Ö —à–∞–≥ –∑–∞ —à–∞–≥–æ–º.

- –ü–æ–∏—Å–∫ —Ä–µ—Ü–µ–ø—Ç–æ–≤: –ò—â–∏—Ç–µ —Ä–µ—Ü–µ–ø—Ç—ã –ø–æ —Ç–µ–≥–∞–º –∏ –∞–≤—Ç–æ—Ä–∞–º.

- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ: –î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è —Ä–µ—Ü–µ–ø—Ç—ã –≤ —Å–≤–æ—é –∫–æ–ª–ª–µ–∫—Ü–∏—é –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –ª–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏—Ö –≤ –±—É–¥—É—â–µ–º.

- –°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫: –°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –±–ª—é–¥, –∏ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –µ–≥–æ. –ü–æ–∑–∂–µ –≤—ã —Å–º–æ–∂–µ—Ç–µ —Å–∫–∞—á–∞—Ç—å —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ –≤ —Ñ–æ—Ä–º–∞—Ç–µ PDF –∏ —Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å, —á—Ç–æ–±—ã –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–±—ã—Ç—å –ø—Ä–∏ –ø–æ—Ö–æ–¥–µ –≤ –º–∞–≥–∞–∑–∏–Ω.

- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∞–≤—Ç–æ—Ä–æ–≤: –í—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –Ω–∞ –∞–≤—Ç–æ—Ä–æ–≤, —á—å–∏ —Ä–µ—Ü–µ–ø—Ç—ã –≤–∞—Å –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—Ç, —á—Ç–æ–±—ã –≤—Å–µ–≥–¥–∞ –±—ã—Ç—å –≤ –∫—É—Ä—Å–µ –∏—Ö –Ω–æ–≤—ã—Ö –∫—É–ª–∏–Ω–∞—Ä–Ω—ã—Ö –∏–¥–µ–π.

***

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –¥–≤–∞ —Ñ–∞–π–ª–∞ **docker-compose.yml** –∏ 
**docker-compose.production.yml**, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ–µ–∫—Ç –Ω–∞
–ª–æ–∫–∞–ª—å–Ω–æ–º –∏–ª–∏ —É–¥–∞–ª—ë–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–∞—Ö.

–î–∞–Ω–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç, —á—Ç–æ –Ω–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º/—É–¥–∞–ª—ë–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Git, Python 3.10, –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä pip, Docker, Docker Compose, —É—Ç–∏–ª–∏—Ç–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è python3-venv.

–í –ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞ –ë–î SQLite3 –∏ PostgreSQL. –í—ã–±–æ—Ä –ë–î –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å–º–µ–Ω–æ–π –∑–Ω–∞—á–µ–Ω–∏—è DEBUG –Ω–∞ True –∏–ª–∏ False. True = SQLite3, False = PostgreSQL.

–° –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –∑–∞–ø—É—Å–∫–∞ –≤—ã –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –Ω–∏–∂–µ.

***

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö —Å –ø–æ–º–æ—â—å—é Docker Compose

–°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```shell
git clone https://github.com/PrimeStr/foodgram-project-react.git
```


–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞:

```shell
cd foodgram-project-react/
```

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é **infra** –∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª **.env**:

```shell
cd infra/
```

```shell
nano .env
```

–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ—Å—è –≤ —Ñ–∞–π–ª–µ **.env.example** –∏ –ø–æ–¥—Å—Ç–∞–≤—å—Ç–µ 
—Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è.

–ü—Ä–∏–º–µ—Ä –∏–∑ .env —Ñ–∞–π–ª–∞:

```dotenv
# –ë–î –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã DEBUG. –ï—Å–ª–∏ DEBUG = True , –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite3.
# –ï—Å–ª–∏ DEBUG = False , –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PostgreSQL.

POSTGRES_USER=django_user            # –í–∞—à–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –±–¥
POSTGRES_PASSWORD=django             # –í–∞—à –ø–∞—Ä–æ–ª—å –¥–ª—è –±–¥
POSTGRES_DB=django                   # –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–π –±–¥
DB_HOST=db                           # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - db
DB_PORT=5432                         # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - 5432


SECRET_KEY=DJANGO_SECRET_KEY         # –í–∞—à —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á Django
DEBUG=False                          # True - –≤–∫–ª—é—á–∏—Ç—å –î–µ–±–∞–≥. –ò–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è False
IS_LOGGING=False                     # True - –≤–∫–ª—é—á–∏—Ç—å –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ. –ò–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è False
ALLOWED_HOSTS=127.0.0.1              # –°–ø–∏—Å–æ–∫ –∞–¥—Ä–µ—Å–æ–≤, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–µ–ª–∞–º–∏

# –ü–æ–º–Ω–∏—Ç–µ, –µ—Å–ª–∏ –≤—ã –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç–µ DEBUG=False, —Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—É–¥–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–ø–∏—Å–æ–∫ ALLOWED_HOSTS.
# 127.0.0.1 —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º. –ë–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤ –∏ –∏–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤.
```

–í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ **infra** –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ñ–∞–π–ª **docker-compose.yml**, —Å 
–ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.

–ù–∞—Ö–æ–¥—è—Å—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ **infra** –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:
> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ.** –ï—Å–ª–∏ –Ω—É–∂–Ω–æ - –¥–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–Ω–µ—Ü –∫–æ–º–∞–Ω–¥—ã —Ñ–ª–∞–≥ **-d** –¥–ª—è –∑–∞–ø—É—Å–∫–∞
> –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ.
```shell
sudo docker compose -f docker-compose.yml up
```

–û–Ω–∞ —Å–±–∏–ª–¥–∏—Ç Docker –æ–±—Ä–∞–∑—ã –∏ –∑–∞–ø—É—Å—Ç–∏—Ç backend, frontend, –°–£–ë–î –∏ Nginx –≤ 
–æ—Ç–¥–µ–ª—å–Ω—ã—Ö Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —Å backend:

```shell
sudo docker compose -f docker-compose.yml exec foodgram-backend python manage.py migrate
```

–°–æ–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏–∫—É backend'a:

```shell
sudo docker compose -f docker-compose.yml exec foodgram-backend python manage.py collectstatic
```

–ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É
http://127.0.0.1/

–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –Ω–∞—Ö–æ–¥—è—Å—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ **infra** –≤—ã–ø–æ–ª–Ω–∏—Ç–µ 
—Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:

```shell
sudo docker compose -f docker-compose.yml down
```

–õ–∏–±–æ –ø—Ä–æ—Å—Ç–æ –∑–∞–≤–µ—Ä—à–∏—Ç–µ —Ä–∞–±–æ—Ç—É Docker Compose –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤—ã –µ–≥–æ
–∑–∞–ø—É—Å–∫–∞–ª–∏, —Å–æ—á–µ—Ç–∞–Ω–∏–µ–º –∫–ª–∞–≤–∏—à **CTRL+C**.

***

# CI/CD - –†–∞–∑–≤—ë—Ä—Ç–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

–í –ø—Ä–æ–µ–∫—Ç–µ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω Workflow –¥–ª—è GitHub Actions.

–í–∞—à GitHub Actions —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç:

- üß™ –¢–µ—Å—Ç—ã: –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–µ—Å—Ç—ã –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.
- üèóÔ∏è –°–±–æ—Ä–∫—É –æ–±—Ä–∞–∑–æ–≤: Git Action —Å–æ–∑–¥–∞–µ—Ç Docker-–æ–±—Ä–∞–∑—ã –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- üöÄ –î–µ–ø–ª–æ–π: –û–±—Ä–∞–∑—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π DockerHub, –ø—Ä–æ–µ–∫—Ç
–¥–µ–ø–ª–æ–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä.
- ‚úâÔ∏è –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –í —Å–ª—É—á–∞–µ —É—Å–ø–µ—Ö–∞ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram.

–§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ GitHub –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è ‚Äî 
**Settings**, –Ω–∞–π–¥–∏—Ç–µ –Ω–∞ –ø–∞–Ω–µ–ª–∏ —Å–ª–µ–≤–∞ –ø—É–Ω–∫—Ç
**Secrets and Variables**, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Actions**, –Ω–∞–∂–º–∏—Ç–µ
**New repository secret**.

–°–æ–∑–¥–∞–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª—é—á–∏:

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ.** –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –≤–∞—à–µ–º—É —É–¥–∞–ª—ë–Ω–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É –≤–æ—Ä–∫–µ—Ä GitHub 
> Actions —Å–æ–∑–¥–∞—Å—Ç .env —Ñ–∞–π–ª, —Å–æ–∑–¥–∞—Å—Ç –ë–î –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å backend'–æ–º, 
> –∏—Å–ø–æ–ª—å–∑—É—è —ç—Ç–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã.

```
# –û–±—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã
DOCKER_USERNAME (–í–∞—à –ª–æ–≥–∏–Ω –≤ DockerHub)
DOCKER_PASSWORD (–í–∞—à –ø–∞—Ä–æ–ª—å –≤ DockerHub)
HOST (IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
USER (–õ–æ–≥–∏–Ω –≤–∞—à–µ–≥–æ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
SSH_KEY (SSH –∫–ª—é—á –≤–∞—à–µ–≥–æ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
SSH_PASSPHRASE (–ü–∞—Ä–æ–ª—å –≤–∞—à–µ–≥–æ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
TELEGRAM_TO (–í–∞—à ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram)
TELEGRAM_TOKEN (–¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram)

# PostgreSQL
POSTGRES_USER(–í–∞—à–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –±–¥)
POSTGRES_PASSWORD(–í–∞—à –ø–∞—Ä–æ–ª—å –¥–ª—è –±–¥)
POSTGRES_DB(–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–π –±–¥)
DB_HOST(–ê–¥—Ä–µ—Å –±–¥. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - db)
DB_PORT(–ü–æ—Ä—Ç –±–¥. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - 5432)

# Django
SECRET_KEY(–í–∞—à —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á Django)
DEBUG(–í–∫–ª/–≤—ã–∫–ª DEBUG)
IS_LOGGING(–í–∫–ª/–≤—ã–∫–ª –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
ALLOWED_HOSTS(–°–ø–∏—Å–æ–∫ –∞–¥—Ä–µ—Å–æ–≤, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–µ–ª–∞–º–∏)
```

> **–í–Ω–∏–º–∞–Ω–∏–µ!** –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –ø–æ–º–∏–º–æ 
localhost –∏ 127.0.0.1 –¥–æ–±–∞–≤–∏—Ç—å –≤ ALLOWED_HOSTS –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞.

–ü—Ä–∏–º–µ—Ä PostgreSQL –∏ Django –∫–æ–Ω—Å—Ç–∞–Ω—Ç –∏–∑ .env —Ñ–∞–π–ª–∞:

```dotenv
POSTGRES_USER=django_user            # –í–∞—à–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –±–¥
POSTGRES_PASSWORD=django             # –í–∞—à –ø–∞—Ä–æ–ª—å –¥–ª—è –±–¥
POSTGRES_DB=django                   # –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–π –±–¥
DB_HOST=db                           # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - db
DB_PORT=5432                         # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - 5432

SECRET_KEY=DJANGO_SECRET_KEY         # –í–∞—à —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á Django
DEBUG=False                          # True - –≤–∫–ª—é—á–∏—Ç—å –î–µ–±–∞–≥. –ò–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è False
IS_LOGGING=False                     # True - –≤–∫–ª—é—á–∏—Ç—å –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ. –ò–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è False
ALLOWED_HOSTS=127.0.0.1              # –°–ø–∏—Å–æ–∫ –∞–¥—Ä–µ—Å–æ–≤, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–µ–ª–∞–º–∏
```

### **–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∞—Ç—å –∫ –¥–µ–ø–ª–æ—é**

> **–í–Ω–∏–º–∞–Ω–∏–µ!** –î–∞–ª—å–Ω–µ–π—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞—é—Ç —á—Ç–æ –Ω–∞ –≤–∞—à–µ–º —É–¥–∞–ª—ë–Ω–Ω–æ–º 
> —Å–µ—Ä–≤–µ—Ä–µ Nginx —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä. –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ Nginx –≤ 
> Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 8500.

–í –ª–æ–∫–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–∞–º–µ–Ω–∏—Ç–µ –≤ —Ñ–∞–π–ª–µ **docker-compose.production.yml** –Ω–∞–∑–≤–∞–Ω–∏—è
–æ–±—Ä–∞–∑–æ–≤ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–∏–º –ª–æ–≥–∏–Ω–æ–º –Ω–∞ DockerHub –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
(–ù–∞–ø—Ä–∏–º–µ—Ä **your_name/foodgram_backend**)

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤ –∏ –≤ —Ñ–∞–π–ª–µ **main.yml**, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è
–≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ **/.github/workflows/**.

–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∞—à–µ–º—É —É–¥–∞–ª—ë–Ω–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É –ª—é–±—ã–º —É–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º. –°–æ–∑–¥–∞–π—Ç–µ –≤
–¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º **foodgram** –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–µ—ë.

```shell
mkdir foodgram
```

–ì–æ—Ç–æ–≤–æ.

–í–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω! –ö–∞–∫ —Ç–æ–ª—å–∫–æ –≤—ã –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç–µ –∫–æ–º–º–∏—Ç –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π 
–º–∞—à–∏–Ω–µ –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ GitHub, GitHub Actions –±–µ—Ä–µ—Ç –¥–µ–ª–æ –≤ —Å–≤–æ–∏ —Ä—É–∫–∏:

```shell
git add .
```

```shell
git commit -m "–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –∫–æ–º–º–∏—Ç–∞."
```

```shell
git push
```

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Å–≤–æ—ë–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –Ω–∞ GitHub –≤–æ
–≤–∫–ª–∞–¥–∫—É **Actions**. –í—ã —É–≤–∏–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã Actions. –ü–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã
–≤–æ—Ä–∫–µ—Ä–∞ –≤ –≤–∞—à Telegram –ø—Ä–∏–¥—ë—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –±–æ—Ç–∞:

> –î–µ–ø–ª–æ–π –ø—Ä–æ–µ–∫—Ç–∞ Foodgram —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω!

**–î–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ø—Ä–æ–≤–µ–¥–µ–Ω—ã 
–º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–æ–±—Ä–∞–Ω–∞ —Å—Ç–∞—Ç–∏–∫–∞ backend'–∞.**

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä, –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é **foodgram** –∏
—Å–æ–∑–¥–∞—Ç—å —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: 

```shell
sudo docker compose -f docker-compose.production.yml exec backend python manage.py createsuperuser
```

>**–í–Ω–∏–º–∞–Ω–∏–µ! :** –î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –≤–∞—à–µ–º —É–¥–∞–ª—ë–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ 
–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω **Nginx**. –£–¥–æ—Å—Ç–æ–≤–µ—Ä—å—Ç–µ—Å—å —á—Ç–æ 
–≤ –∫–æ–Ω—Ñ–∏–≥–µ –ø–æ –≤–∞—à–µ–º—É –¥–æ–º–µ–Ω–Ω–æ–º—É –∏–º–µ–Ω–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞
**127.0.0.1:8500** –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ Let's Encrypt

–ß—Ç–æ–±—ã –ø—Ä–æ–µ–∫—Ç –æ—Ç–≤–µ—á–∞–ª –±–∞–∑–æ–≤—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç.

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ **certbot**:

```shell
sudo apt install snapd
```

```shell
sudo snap install core; sudo snap refresh core
```

```shell
sudo snap install --classic certbot
```

```shell
sudo ln -s /snap/bin/certbot /usr/bin/certbot
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ sertbot –∏ –ø–æ–ª—É—á–∏—Ç–µ —Å–≤–æ–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:

```shell
sudo certbot --nginx
```

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx:

```shell
sudo systemctl reload nginx
```  

```shell
sudo certbot certificates
```  

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ.** SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ—Ç Let's Encrypt –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 
90 –¥–Ω–µ–π. –ò—Ö –Ω—É–∂–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å. –ï—Å–ª–∏ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ –¥–µ–ª–∞—Ç—å —ç—Ç–æ 
—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ 
—Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã –Ω–∏–∂–µ.

```shell
sudo certbot renew --dry-run
```  

**–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–∞–π—Ç—É –ø–æ –µ–≥–æ –¥–æ–º–µ–Ω–Ω–æ–º—É –∏–º–µ–Ω–∏.**

**–ö–∞–∫ —Ç–æ–ª—å–∫–æ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º, 
–≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—á–∞—Ç—å –ø—Ä–∏–≥–ª–∞—à–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º–∏ 
–∫—É–ª–∏–Ω–∞—Ä–Ω—ã–º–∏ —à–µ–¥–µ–≤—Ä–∞–º–∏.**

***

## –ê–≤—Ç–æ—Ä

**–ú–∞–∫—Å–∏–º –ì–æ–ª–æ–≤–∏–Ω**\
–í—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥–ª—è–Ω—É—Ç—å –≤ –¥—Ä—É–≥–∏–µ –º–æ–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤ –º–æ–µ–º –ø—Ä–æ—Ñ–∏–ª–µ GitHub. 
–ù–∞–∂–º–∏—Ç–µ [–∑–¥–µ—Å—å](https://github.com/PrimeStr).

***
***

# Foodgram - Get inspired and share delicious dishes with the whole world!

***

#### Project link: primestr.sytes.net

***

# English version

–ò—â–µ—Ç–µ –†—É—Å—Å–∫—É—é –≤–µ—Ä—Å–∏—é? –í–∞–º —Å—é–¥–∞ --> [click](#—Ä—É—Å—Å–∫–∞—è-–≤–µ—Ä—Å–∏—è) –∏–ª–∏ –ª–∏—Å—Ç–∞–π—Ç–µ –≤–≤–µ—Ä—Ö.

***
***

## Stack:

[![Python](https://img.shields.io/badge/Python-%203.10-blue?style=flat-square&logo=Python)](https://www.python.org/)
[![Django](https://img.shields.io/badge/Django-%203.2.3-blue?style=flat-square&logo=django)](https://www.djangoproject.com/)
[![DRF](https://img.shields.io/badge/DjangoRESTFramework-%20-blue?style=flat-square&logo=django)](https://www.django-rest-framework.org/)
[![Docker](https://img.shields.io/badge/Docker-%2024.0.5-blue?style=flat-square&logo=docker)](https://www.docker.com/)
[![DockerCompose](https://img.shields.io/badge/Docker_Compose-%202.21.0-blue?style=flat-square&logo=docsdotrs)](https://docs.docker.com/compose/)
[![GitHub Actions](https://img.shields.io/badge/GitHub_Actions-%20-blue?style=flat-square&logo=githubactions)](https://github.com/features/actions)
[![Gunicorn](https://img.shields.io/badge/Gunicorn-%2020.1.0-blue?style=flat-square&logo=gunicorn)](https://gunicorn.org/)
[![Nginx](https://img.shields.io/badge/Nginx-%20-blue?style=flat-square&logo=nginx)](https://www.nginx.com/)
[![React](https://img.shields.io/badge/React-%20-blue?style=flat-square&logo=react)](https://react.dev/)
[![React](https://img.shields.io/badge/certbot-%20-blue?style=flat-square&logo=letsencrypt)](https://certbot.eff.org/)

***

## Functionality:

Foodgram provides the following features:

- **Adding and editing recipes**: Create beautifully designed recipes, add 
photos of your dishes and tell others how to cook it step by step.

- **Search for recipes**: Search for recipes by tags and authors.

- **Save to Favorites**: Add your favorite recipes to your favorites 
collection to easily find them in the future.

- **Shopping List**: Create a shopping list based on the ingredients needed to 
prepare selected dishes and save it. Later you will be able to download this 
list in PDF format and print it out so that you don't forget anything when 
going to the store.

- **Subscribe to authors**: You can subscribe to authors whose recipes inspire 
you to always be aware of their new culinary ideas.

***

## Technical features:

The repository includes two files **docker-compose.yml** and
**docker-compose.production.yml**, which allows you to deploy the project on
local or remote servers.

This instruction implies that Git, Python 3.10, pip package manager, Docker, 
Docker Compose and python3-venv virtual environment utility are already 
installed on your local/remote server.

The project provides the ability to run SQLite3 and PostgreSQL databases. 
The database is selected by changing the DEBUG value to True or False. 
True = SQLite3, False = PostgreSQL.

Detailed launch instructions can be found below.

***

## Running a project locally in Docker-containers using Docker Compose:

Clone the project from the repository:

```shell
git clone https://github.com/PrimeStr/foodgram-project-react.git
```


Go to the project directory:

```shell
cd foodgram-project-react/
```

Go to the **infra** directory and create the **.env** file:

```shell
cd infra/
```

```shell
nano .env
```

Add the lines contained in the **.env.example** file and 
substitute your values.

Example from .env file:

```dotenv
# DB is selected automatically based on the DEBUG constant. If DEBUG = True, SQLite3 is used.
# If DEBUG = False, PostgreSQL is used.

POSTGRES_USER=django_user            # Your db username
POSTGRES_PASSWORD=django             # Your db password
POSTGRES_DB=django                   # Name of your database
DB_HOST=db                           # The standard value is db
DB_PORT=5432                         # The standard value is 5432


SECRET_KEY=DJANGO_SECRET_KEY         # Your Django Secret Key
DEBUG=False                          # True - enable Debug. Or leave it empty for False
IS_LOGGING=False                     # True - enable Logging. Or leave it empty for False
ALLOWED_HOSTS=127.0.0.1              # A list of addresses separated by spaces

# Remember, if you set DEBUG=False, you will need to configure the ALLOWED_HOSTS list.
# 127.0.0.1 is the standard value. Without spaces or other characters.
```

The **infra** directory of the project contains the **docker-compose.yml** 
file, with which you can run the project locally in Docker containers.

While in the **infra** directory, run the following command:

> **Note.** If necessary, add the **-d** flag to the end of the command to run
> it in the background.

```shell
sudo docker compose -f docker-compose.yml up
```

It will build Docker images and run backend, frontend, DBMS and Nginx in 
separate Docker containers.

Perform migrations in a container with a backend:

```shell
sudo docker compose -f docker-compose.yml exec foodgram-backend python manage.py migrate
```

Collect backend static:

```shell
sudo docker compose -f docker-compose.yml exec foodgram-backend python manage.py collectstatic
```

Upon completion of all operations, the project will be launched and available 
at http://127.0.0.1/

To stop Docker containers while in the **infra** directory, run 
the following command:

```shell
sudo docker compose -f docker-compose.yml down
```

Or simply shut down Docker Compose in the terminal in which you
launched it, using the keyboard shortcut **CTRL+C**.

***

# CI/CD - Project deployment on a remote server

Workflow for GitHub Actions is already configured in the project.

Your GitHub Actions will independently launch:

- üß™ Tests: Run tests for your project.
- üèóÔ∏è Image Assembly: Get Action creates Docker images of your application.
- üöÄ Deployment: Images are sent to your DockerHub repository, the project 
is deployed to the server.
- ‚úâÔ∏è Notification: If successful, you will receive a notification in Telegram.

Fork the repository, go to GitHub in the repository settings ‚Äî
**Settings**, find the item on the left panel
**Secrets and Variables**, go to **Actions**, click
**New repository secret**.

Create the following keys:

> **Note.** When connecting to your remote server GitHub Actions worker will 
> create a .env file, create a database and launch a container with a backend,
> using these constants.

```
# Shared secrets
DOCKER_USERNAME (Your login in DockerHub)
DOCKER_PASSWORD (Your password in DockerHub)
HOST (IP address of your remote server)
USER (Login of your remote server)
SSH_KEY (SSH key of your remote server)
SSH_PASSPHRASE (Password of your remote server)
TELEGRAM_TO (Your user ID in Telegram)
TELEGRAM_TOKEN (Token of your bot in Telegram)

# PostgreSQL
POSTGRES_USER (Your db username)
POSTGRES_PASSWORD (Your db password)
POSTGRES_DB (Your DB name)
DB_HOST (Db address. The standard value is db)
DB_PORT (Db port. The standard value is 5432)

# Django
SECRET_KEY (Your Django Secret key)
DEBUG (On/Off DEBUG)
IS_LOGGING (On/Off Logging)
ALLOWED_HOSTS (A list of addresses separated by spaces)
```

> **Attention!** For the correct display of images, do not forget to add the 
> domain name of your site to ALLOWED_HOSTS in addition to localhost 
> and 127.0.0.1.

Example of PostgreSQL and Django constants from .env file:

```dotenv
POSTGRES_USER=django_user            # Your db username
POSTGRES_PASSWORD=django             # Your db password
POSTGRES_DB=django                   # Name of your DB
DB_HOST=db                           # Standard value - db
DB_PORT=5432                         # The standard value is 5432

SECRET_KEY=DJANGO_SECRET_KEY         # Your Django Secret Key
DEBUG=False                          # True - enable Debug. Or leave it empty for False
IS_LOGGING=False                     # True - enable Logging. Or leave it empty for False
ALLOWED_HOSTS=127.0.0.1              # A list of addresses separated by spaces
```

### **Now you can proceed to the deployment**

> **Attention!** Further actions imply that on your remote server
> Nginx is installed and configured as a proxy server. Initially Nginx in
> Docker container listens on port 8500.

In the local project, replace the image names in the 
**docker-compose.production.yml** file in accordance with your login to 
DockerHub in lowercase (For example **your_name/foodgram_backend**)

Similarly, change the names of the images in the **main.yml** file, which 
is located in the **/.github/workflows/** directory.

Connect to your remote server in any convenient way. Create a directory in
your home directory with the name **foodgram** and go to it.

```shell
mkdir foodgram
```

Done.

The whole process is automated! As soon as you initiate a commit on the local 
machine and send the changes to GitHub, GitHub Actions takes matters 
into its own hands:

```shell
git add .
```

```shell
git commit -m "Your message for the commit."
```

```shell
git push
```

After successfully submitting the changes, go to the **Actions** tab in 
your GitHub repository. You will see the Actions process. After the end of
the worker's work, a message from the bot will come to your Telegram:

> –î–µ–ø–ª–æ–π –ø—Ä–æ–µ–∫—Ç–∞ Foodgram —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω!

**This message means that the project has been successfully launched on the 
server, migrations have been performed and backend static has been collected.**

After that, you can return to the remote server, to the **foodgram** directory 
and create a superuser:

```shell
sudo docker compose -f docker-compose.production.yml exec backend python manage.py createsuperuser
```

>**Attention! :** For the project to work properly, **Nginx** must be 
installed, configured and running on your remote server. Make sure that 
the config for your domain name is configured to forward all requests to
**127.0.0.1:8500** and header forwarding is added.

### Configuring SSL encryption via Let's Encrypt

In order for the project to meet the basic security standards, you need to 
configure SSL certificate.

Install **certbot**:

```shell
sudo apt install snapd
```

```shell
sudo snap install core; sudo snap refresh core
```

```shell
sudo snap install --classic certbot
```

```shell
sudo ln -s /snap/bin/certbot /usr/bin/certbot
```

Launch sertbot and get your SSL certificate:

```shell
sudo certbot --nginx
```

Then restart Nginx:

```shell
sudo systemctl reload nginx
```  

```shell
sudo certbot certificates
```  

> **Note.** SSL certificates from Let's Encrypt are valid for 90 days. 
They need to be constantly updated. If you don't want to do this yourself, 
you can configure automatic certificate renewal using the command below.

```shell
sudo certbot renew --dry-run
```  

**Now you can access the site by its domain name.**

**As soon as you make sure that all recipes are displayed correctly and 
without problems, you can start inviting users to share their 
culinary masterpieces.**

***

## Author

**Maxim Golovin**\
You can take a look at my other repositories in my GitHub profile. 
Click [here](https://github.com/PrimeStr).
